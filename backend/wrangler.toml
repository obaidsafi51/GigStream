# Cloudflare Workers Configuration
# https://developers.cloudflare.com/workers/wrangler/configuration/

name = "gigstream-api"
main = "src/index.ts"
compatibility_date = "2024-11-01"
compatibility_flags = ["nodejs_compat"]

# Account and deployment settings
account_id = "862b03ad21f8a46cdf0fc853a3b3b579"
workers_dev = true
preview_urls = false  # Disable preview URLs to suppress warning

# Cloudflare Workers AI Binding (Remote Mode)
[ai]
binding = "AI"
remote = true  # Suppress warning about remote resource usage

# Route configuration (when deploying to custom domain)
# routes = [
#   { pattern = "api.gigstream.com/*", zone_name = "gigstream.com" }
# ]

# Environment variables for local development
# Note: Sensitive values (DATABASE_URL, JWT_SECRET, CIRCLE keys) should be set via:
# - .dev.vars file for local development (automatically loaded by wrangler dev)
# - `wrangler secret put` for production deployments
[vars]
# Wallet Service (Node.js standalone)
WALLET_SERVICE_URL = "http://localhost:3001"
WALLET_SERVICE_SECRET = "dev-secret-change-in-production"

# Arc Blockchain
ARC_RPC_URL = "https://rpc.testnet.arc.network"
ARC_CHAIN_ID = "5042002"
ARC_EXPLORER_URL = "https://explorer.circle.com/arc-testnet"

# Application Settings
NODE_ENV = "development"
API_PORT = "8787"
API_BASE_URL = "http://localhost:8787"
LOG_LEVEL = "debug"

# Feature Flags
ENABLE_PAYMENT_STREAMING = "true"
ENABLE_MICRO_LOANS = "true"
ENABLE_AI_VERIFICATION = "false"
DEMO_MODE_ENABLED = "true"

# JWT Settings (non-sensitive defaults, override in .dev.vars)
JWT_ACCESS_TOKEN_EXPIRY = "24h"
JWT_REFRESH_TOKEN_EXPIRY = "7d"

# Environment variables (use `wrangler secret put` for sensitive values)
# Note: Use `wrangler deploy --env production` or `wrangler deploy --env staging`
[env.production]
name = "gigstream-api-production"
account_id = "862b03ad21f8a46cdf0fc853a3b3b579"

[env.production.ai]
binding = "AI"
remote = true

[env.staging]
name = "gigstream-api-staging"
account_id = "862b03ad21f8a46cdf0fc853a3b3b579"

[env.staging.ai]
binding = "AI"
remote = true

# Database bindings (Neon PostgreSQL via HTTP)
# [env.production.vars]
# DATABASE_URL = "postgresql://..."

# Service bindings
# [[services]]
# binding = "MY_SERVICE"
# service = "my-service-name"
